/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var io=Object.create;var nt=Object.defineProperty;var ro=Object.getOwnPropertyDescriptor;var so=Object.getOwnPropertyNames;var lo=Object.getPrototypeOf,ao=Object.prototype.hasOwnProperty;var uo=(n,e,t)=>e in n?nt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var co=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),fo=(n,e)=>{for(var t in e)nt(n,t,{get:e[t],enumerable:!0})},un=(n,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of so(e))!ao.call(n,r)&&r!==t&&nt(n,r,{get:()=>e[r],enumerable:!(o=ro(e,r))||o.enumerable});return n};var mo=(n,e,t)=>(t=n!=null?io(lo(n)):{},un(e||!n||!n.__esModule?nt(t,"default",{value:n,enumerable:!0}):t,n)),po=n=>un(nt({},"__esModule",{value:!0}),n);var re=(n,e,t)=>(uo(n,typeof e!="symbol"?e+"":e,t),t);var An=co((Qt,Xt)=>{(function(n,e){typeof Qt=="object"&&typeof Xt!="undefined"?Xt.exports=e():typeof define=="function"&&define.amd?define(e):(n=typeof globalThis!="undefined"?globalThis:n||self).dayjs=e()})(Qt,function(){"use strict";var n=1e3,e=6e4,t=36e5,o="millisecond",r="second",i="minute",s="hour",a="day",h="week",l="month",g="quarter",c="year",b="date",D="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,L={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(y){var m=["th","st","nd","rd"],u=y%100;return"["+y+(m[(u-20)%10]||m[u]||m[0])+"]"}},q=function(y,m,u){var p=String(y);return!p||p.length>=m?y:""+Array(m+1-p.length).join(u)+y},$={s:q,z:function(y){var m=-y.utcOffset(),u=Math.abs(m),p=Math.floor(u/60),d=u%60;return(m<=0?"+":"-")+q(p,2,"0")+":"+q(d,2,"0")},m:function y(m,u){if(m.date()<u.date())return-y(u,m);var p=12*(u.year()-m.year())+(u.month()-m.month()),d=m.clone().add(p,l),C=u-d<0,S=m.clone().add(p+(C?-1:1),l);return+(-(p+(u-d)/(C?d-S:S-d))||0)},a:function(y){return y<0?Math.ceil(y)||0:Math.floor(y)},p:function(y){return{M:l,y:c,w:h,d:a,D:b,h:s,m:i,s:r,ms:o,Q:g}[y]||String(y||"").toLowerCase().replace(/s$/,"")},u:function(y){return y===void 0}},ee="en",G={};G[ee]=L;var oe=function(y){return y instanceof K},ie=function y(m,u,p){var d;if(!m)return ee;if(typeof m=="string"){var C=m.toLowerCase();G[C]&&(d=C),u&&(G[C]=u,d=C);var S=m.split("-");if(!d&&S.length>1)return y(S[0])}else{var R=m.name;G[R]=m,d=R}return!p&&d&&(ee=d),d||!p&&ee},T=function(y,m){if(oe(y))return y.clone();var u=typeof m=="object"?m:{};return u.date=y,u.args=arguments,new K(u)},M=$;M.l=ie,M.i=oe,M.w=function(y,m){return T(y,{locale:m.$L,utc:m.$u,x:m.$x,$offset:m.$offset})};var K=function(){function y(u){this.$L=ie(u.locale,null,!0),this.parse(u)}var m=y.prototype;return m.parse=function(u){this.$d=function(p){var d=p.date,C=p.utc;if(d===null)return new Date(NaN);if(M.u(d))return new Date;if(d instanceof Date)return new Date(d);if(typeof d=="string"&&!/Z$/i.test(d)){var S=d.match(v);if(S){var R=S[2]-1||0,Y=(S[7]||"0").substring(0,3);return C?new Date(Date.UTC(S[1],R,S[3]||1,S[4]||0,S[5]||0,S[6]||0,Y)):new Date(S[1],R,S[3]||1,S[4]||0,S[5]||0,S[6]||0,Y)}}return new Date(d)}(u),this.$x=u.x||{},this.init()},m.init=function(){var u=this.$d;this.$y=u.getFullYear(),this.$M=u.getMonth(),this.$D=u.getDate(),this.$W=u.getDay(),this.$H=u.getHours(),this.$m=u.getMinutes(),this.$s=u.getSeconds(),this.$ms=u.getMilliseconds()},m.$utils=function(){return M},m.isValid=function(){return this.$d.toString()!==D},m.isSame=function(u,p){var d=T(u);return this.startOf(p)<=d&&d<=this.endOf(p)},m.isAfter=function(u,p){return T(u)<this.startOf(p)},m.isBefore=function(u,p){return this.endOf(p)<T(u)},m.$g=function(u,p,d){return M.u(u)?this[p]:this.set(d,u)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(u,p){var d=this,C=!!M.u(p)||p,S=M.p(u),R=function(de,V){var se=M.w(d.$u?Date.UTC(d.$y,V,de):new Date(d.$y,V,de),d);return C?se:se.endOf(a)},Y=function(de,V){return M.w(d.toDate()[de].apply(d.toDate("s"),(C?[0,0,0,0]:[23,59,59,999]).slice(V)),d)},U=this.$W,z=this.$M,ae=this.$D,Oe="set"+(this.$u?"UTC":"");switch(S){case c:return C?R(1,0):R(31,11);case l:return C?R(1,z):R(0,z+1);case h:var xe=this.$locale().weekStart||0,qe=(U<xe?U+7:U)-xe;return R(C?ae-qe:ae+(6-qe),z);case a:case b:return Y(Oe+"Hours",0);case s:return Y(Oe+"Minutes",1);case i:return Y(Oe+"Seconds",2);case r:return Y(Oe+"Milliseconds",3);default:return this.clone()}},m.endOf=function(u){return this.startOf(u,!1)},m.$set=function(u,p){var d,C=M.p(u),S="set"+(this.$u?"UTC":""),R=(d={},d[a]=S+"Date",d[b]=S+"Date",d[l]=S+"Month",d[c]=S+"FullYear",d[s]=S+"Hours",d[i]=S+"Minutes",d[r]=S+"Seconds",d[o]=S+"Milliseconds",d)[C],Y=C===a?this.$D+(p-this.$W):p;if(C===l||C===c){var U=this.clone().set(b,1);U.$d[R](Y),U.init(),this.$d=U.set(b,Math.min(this.$D,U.daysInMonth())).$d}else R&&this.$d[R](Y);return this.init(),this},m.set=function(u,p){return this.clone().$set(u,p)},m.get=function(u){return this[M.p(u)]()},m.add=function(u,p){var d,C=this;u=Number(u);var S=M.p(p),R=function(z){var ae=T(C);return M.w(ae.date(ae.date()+Math.round(z*u)),C)};if(S===l)return this.set(l,this.$M+u);if(S===c)return this.set(c,this.$y+u);if(S===a)return R(1);if(S===h)return R(7);var Y=(d={},d[i]=e,d[s]=t,d[r]=n,d)[S]||1,U=this.$d.getTime()+u*Y;return M.w(U,this)},m.subtract=function(u,p){return this.add(-1*u,p)},m.format=function(u){var p=this,d=this.$locale();if(!this.isValid())return d.invalidDate||D;var C=u||"YYYY-MM-DDTHH:mm:ssZ",S=M.z(this),R=this.$H,Y=this.$m,U=this.$M,z=d.weekdays,ae=d.months,Oe=d.meridiem,xe=function(V,se,Be,te){return V&&(V[se]||V(p,C))||Be[se].slice(0,te)},qe=function(V){return M.s(R%12||12,V,"0")},de=Oe||function(V,se,Be){var te=V<12?"AM":"PM";return Be?te.toLowerCase():te};return C.replace(x,function(V,se){return se||function(Be){switch(Be){case"YY":return String(p.$y).slice(-2);case"YYYY":return M.s(p.$y,4,"0");case"M":return U+1;case"MM":return M.s(U+1,2,"0");case"MMM":return xe(d.monthsShort,U,ae,3);case"MMMM":return xe(ae,U);case"D":return p.$D;case"DD":return M.s(p.$D,2,"0");case"d":return String(p.$W);case"dd":return xe(d.weekdaysMin,p.$W,z,2);case"ddd":return xe(d.weekdaysShort,p.$W,z,3);case"dddd":return z[p.$W];case"H":return String(R);case"HH":return M.s(R,2,"0");case"h":return qe(1);case"hh":return qe(2);case"a":return de(R,Y,!0);case"A":return de(R,Y,!1);case"m":return String(Y);case"mm":return M.s(Y,2,"0");case"s":return String(p.$s);case"ss":return M.s(p.$s,2,"0");case"SSS":return M.s(p.$ms,3,"0");case"Z":return S}return null}(V)||S.replace(":","")})},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(u,p,d){var C,S=this,R=M.p(p),Y=T(u),U=(Y.utcOffset()-this.utcOffset())*e,z=this-Y,ae=function(){return M.m(S,Y)};switch(R){case c:C=ae()/12;break;case l:C=ae();break;case g:C=ae()/3;break;case h:C=(z-U)/6048e5;break;case a:C=(z-U)/864e5;break;case s:C=z/t;break;case i:C=z/e;break;case r:C=z/n;break;default:C=z}return d?C:M.a(C)},m.daysInMonth=function(){return this.endOf(l).$D},m.$locale=function(){return G[this.$L]},m.locale=function(u,p){if(!u)return this.$L;var d=this.clone(),C=ie(u,p,!0);return C&&(d.$L=C),d},m.clone=function(){return M.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},y}(),W=K.prototype;return T.prototype=W,[["$ms",o],["$s",r],["$m",i],["$H",s],["$W",a],["$M",l],["$y",c],["$D",b]].forEach(function(y){W[y[1]]=function(m){return this.$g(m,y[0],y[1])}}),T.extend=function(y,m){return y.$i||(y(m,K,T),y.$i=!0),T},T.locale=ie,T.isDayjs=oe,T.unix=function(y){return T(1e3*y)},T.en=G[ee],T.Ls=G,T.p={},T})});var bi={};fo(bi,{default:()=>Ot});module.exports=po(bi);var no=require("obsidian");var ho=require("obsidian"),cn={};var Je=require("obsidian");var fn=require("obsidian"),Re=class{constructor(e){this.content=e}async render(e,t,o){await fn.MarkdownRenderer.renderMarkdown(this.content,e,t,o)}};var He=class{toMarkdown(){return new Re(this.toString())}};var ot=class extends He{getType(){return"LITERAL"}};var Fe=class extends He{constructor(){super();this.markdownElements=[]}getType(){return"NON_LITERAL"}addElement(t){if(this.allowElement(t))this.markdownElements.push(t);else throw new Error("Element not allowed in container.")}addText(t){let o=new Me(t,!1,!1,!1);return this.addElement(o),this}addBoldText(t){let o=new Me(t,!0,!1,!1);return this.addElement(o),this}addCursiveText(t){let o=new Me(t,!1,!0,!1);return this.addElement(o),this}addUnderlinedText(t){let o=new Me(t,!1,!1,!0);return this.addElement(o),this}addCode(t){let o=new it(t);return this.addElement(o),this}createParagraph(t){let o=new st(t);return this.addElement(o),o}createHeading(t,o){let r=new rt(t,o);return this.addElement(r),r}createBlockQuote(){let t=new at;return this.addElement(t),t}createCallout(t,o,r=""){let i=new ut(t,o,r);return this.addElement(i),i}createCodeBlock(t,o){let r=new lt(t,o);return this.addElement(r),r}createTable(t,o){let r=new ct(t,o);return this.addElement(r),r}},Me=class extends ot{constructor(t,o,r,i){super();this.content=t,this.bold=o,this.cursive=r,this.underline=i}toString(){let t="",o="";return this.underline&&(t+="<b>",o="</b>"+o),this.bold&&(t+="**",o="**"+o),this.cursive&&(t+="*",o="*"+o),t+this.content+o}},it=class extends ot{constructor(t){super();this.content=t}toString(){return`\`${this.content}\``}},rt=class extends Fe{constructor(t,o){super();this.level=t,this.addText(o)}toString(){return`${"#".repeat(this.level)} ${this.markdownElements.map(t=>t.toString()).join("")}`}allowElement(t){return t.getType()==="LITERAL"}},st=class extends Fe{constructor(e){super(),this.addText(e)}toString(){return this.markdownElements.map(e=>e.toString()).join("")}allowElement(e){return e.getType()==="LITERAL"}},lt=class extends Fe{constructor(t,o){super();this.language=t,this.addText(o)}allowElement(t){return t.getType()==="LITERAL"}toString(){return`\`\`\`${this.language}
${this.markdownElements.map(t=>t.toString()).join("")}
\`\`\``}},at=class extends Fe{allowElement(e){return!0}toString(){return"> "+this.markdownElements.map(e=>e.toString().replaceAll(`
`,`
> `)).join(`
> 
> `)}},ut=class extends Fe{constructor(t,o,r){super();this.title=t,this.type=o,this.args=r}allowElement(t){return!0}toString(){return`> [!${this.type}|${this.args}] ${this.title}
> `+this.markdownElements.map(t=>t.toString().replaceAll(`
`,`
> `)).join(`
> 
> `)}},ct=class extends Fe{constructor(t,o){super();this.header=t,this.body=o}allowElement(t){return!0}toString(){let t=this.body.length;if(t===0)return"";let o=this.header.length;if(o===0)return"";for(let s of this.body)if(s.length!==o)throw new Error("Table rows are do not contain the same number of columns.");let r=[];for(let s=0;s<o;s++){let a=0;this.header[s].length>a&&(a=this.header[s].length);for(let h of this.body)h[s].length>a&&(a=h[s].length);r.push(a)}let i="";i+="|";for(let s=0;s<o;s++){let a=this.header[s];a+=" ".repeat(r[s]-a.length),i+=" "+a+" |"}i+=`
`,i+="|";for(let s=0;s<o;s++)i+=" "+"-".repeat(r[s])+" |";i+=`
`;for(let s=0;s<t;s++){i+="|";for(let a=0;a<o;a++){let h=this.body[s][a];h+=" ".repeat(r[a]-h.length),i+=" "+h+" |"}i+=`
`}return i}};var Ue=class extends Fe{constructor(){super()}toString(){return this.markdownElements.map(e=>e.toString()).join(`

`)}allowElement(e){return!0}};var St=require("obsidian");var Un=require("obsidian");function J(){}var ft=n=>n;function Dt(n){return n()}function ht(){return Object.create(null)}function Q(n){n.forEach(Dt)}function le(n){return typeof n=="function"}function A(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function dn(n){return Object.keys(n).length===0}function go(n,...e){if(n==null){for(let o of e)o(void 0);return J}let t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function mn(n,e,t){n.$$.on_destroy.push(go(e,t))}function Pe(n){return n&&le(n.destroy)?n.destroy:J}var pn=typeof window!="undefined",Lt=pn?()=>window.performance.now():()=>Date.now(),dt=pn?n=>requestAnimationFrame(n):J;var Ge=new Set;function hn(n){Ge.forEach(e=>{e.c(n)||(Ge.delete(e),e.f())}),Ge.size!==0&&dt(hn)}function jt(n){let e;return Ge.size===0&&dt(hn),{promise:new Promise(t=>{Ge.add(e={c:n,f:t})}),abort(){Ge.delete(e)}}}var Nt=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;var Ye=class{constructor(e){re(this,"_listeners","WeakMap"in Nt?new WeakMap:void 0);re(this,"_observer");re(this,"options");this.options=e}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!=null?e:this._observer=new ResizeObserver(t=>{var o;for(let r of t)Ye.entries.set(r.target,r),(o=this._listeners.get(r.target))==null||o(r)})}};Ye.entries="WeakMap"in Nt?new WeakMap:void 0;var _n=!1;function gn(){_n=!0}function bn(){_n=!1}function f(n,e){n.appendChild(e)}function qt(n){if(!n)return document;let e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function vn(n){let e=_("style");return e.textContent="/* empty */",vo(qt(n),e),e.sheet}function vo(n,e){return f(n.head||n,e),e.sheet}function k(n,e,t){n.insertBefore(e,t||null)}function w(n){n.parentNode&&n.parentNode.removeChild(n)}function Ve(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function _(n){return document.createElement(n)}function B(n){return document.createTextNode(n)}function j(){return B(" ")}function ne(n,e,t,o){return n.addEventListener(e,t,o),()=>n.removeEventListener(e,t,o)}function E(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function yn(n){return Array.from(n.childNodes)}function Z(n,e){e=""+e,n.data!==e&&(n.data=e)}function _t(n,e,{bubbles:t=!1,cancelable:o=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:o})}function wn(n){let e={};return n.childNodes.forEach(t=>{e[t.slot||"default"]=!0}),e}var gt=new Map,bt=0;function yo(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function wo(n,e){let t={stylesheet:vn(e),rules:{}};return gt.set(n,t),t}function vt(n,e,t,o,r,i,s,a=0){let h=16.666/o,l=`{
`;for(let L=0;L<=1;L+=h){let q=e+(t-e)*i(L);l+=L*100+`%{${s(q,1-q)}}
`}let g=l+`100% {${s(t,1-t)}}
}`,c=`__svelte_${yo(g)}_${a}`,b=qt(n),{stylesheet:D,rules:v}=gt.get(b)||wo(b,n);v[c]||(v[c]=!0,D.insertRule(`@keyframes ${c} ${g}`,D.cssRules.length));let x=n.style.animation||"";return n.style.animation=`${x?`${x}, `:""}${c} ${o}ms linear ${r}ms 1 both`,bt+=1,c}function Bt(n,e){let t=(n.style.animation||"").split(", "),o=t.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),r=t.length-o.length;r&&(n.style.animation=o.join(", "),bt-=r,bt||ko())}function ko(){dt(()=>{bt||(gt.forEach(n=>{let{ownerNode:e}=n.stylesheet;e&&w(e)}),gt.clear())})}var Qe;function De(n){Qe=n}var ze=[];var ve=[],Ze=[],Jt=[],Eo=Promise.resolve(),Wt=!1;function kn(){Wt||(Wt=!0,Eo.then(yt))}function Le(n){Ze.push(n)}function Ke(n){Jt.push(n)}var Rt=new Set,Xe=0;function yt(){if(Xe!==0)return;let n=Qe;do{try{for(;Xe<ze.length;){let e=ze[Xe];Xe++,De(e),xo(e.$$)}}catch(e){throw ze.length=0,Xe=0,e}for(De(null),ze.length=0,Xe=0;ve.length;)ve.pop()();for(let e=0;e<Ze.length;e+=1){let t=Ze[e];Rt.has(t)||(Rt.add(t),t())}Ze.length=0}while(ze.length);for(;Jt.length;)Jt.pop()();Wt=!1,Rt.clear(),De(n)}function xo(n){if(n.fragment!==null){n.update(),Q(n.before_update);let e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Le)}}function En(n){let e=[],t=[];Ze.forEach(o=>n.indexOf(o)===-1?e.push(o):t.push(o)),t.forEach(o=>o()),Ze=e}var mt;function Mo(){return mt||(mt=Promise.resolve(),mt.then(()=>{mt=null})),mt}function zt(n,e,t){n.dispatchEvent(_t(`${e?"intro":"outro"}${t}`))}var wt=new Set,je;function Se(){je={r:0,c:[],p:je}}function Ce(){je.r||Q(je.c),je=je.p}function P(n,e){n&&n.i&&(wt.delete(n),n.i(e))}function N(n,e,t,o){if(n&&n.o){if(wt.has(n))return;wt.add(n),je.c.push(()=>{wt.delete(n),o&&(t&&n.d(1),o())}),n.o(e)}else o&&o()}var So={duration:0};function kt(n,e,t,o){let i=e(n,t,{direction:"both"}),s=o?0:1,a=null,h=null,l=null,g;function c(){l&&Bt(n,l)}function b(v,x){let L=v.b-s;return x*=Math.abs(L),{a:s,b:v.b,d:L,duration:x,start:v.start,end:v.start+x,group:v.group}}function D(v){let{delay:x=0,duration:L=300,easing:q=ft,tick:$=J,css:ee}=i||So,G={start:Lt()+x,b:v};v||(G.group=je,je.r+=1),"inert"in n&&(v?g!==void 0&&(n.inert=g):(g=n.inert,n.inert=!0)),a||h?h=G:(ee&&(c(),l=vt(n,s,v,L,x,q,ee)),v&&$(0,1),a=b(G,L),Le(()=>zt(n,v,"start")),jt(oe=>{if(h&&oe>h.start&&(a=b(h,L),h=null,zt(n,a.b,"start"),ee&&(c(),l=vt(n,s,a.b,a.duration,0,q,i.css))),a){if(oe>=a.end)$(s=a.b,1-s),zt(n,a.b,"end"),h||(a.b?c():--a.group.r||Q(a.group.c)),a=null;else if(oe>=a.start){let ie=oe-a.start;s=a.a+a.d*q(ie/a.duration),$(s,1-s)}}return!!(a||h)}))}return{run(v){le(i)?Mo().then(()=>{i=i({direction:v?"in":"out"}),D(v)}):D(v)},end(){c(),a=h=null}}}function ke(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function xn(n,e){n.d(1),e.delete(n.key)}function Mn(n,e,t,o,r,i,s,a,h,l,g,c){let b=n.length,D=i.length,v=b,x={};for(;v--;)x[n[v].key]=v;let L=[],q=new Map,$=new Map,ee=[];for(v=D;v--;){let T=c(r,i,v),M=t(T),K=s.get(M);K?o&&ee.push(()=>K.p(T,e)):(K=l(M,T),K.c()),q.set(M,L[v]=K),M in x&&$.set(M,Math.abs(v-x[M]))}let G=new Set,oe=new Set;function ie(T){P(T,1),T.m(a,g),s.set(T.key,T),g=T.first,D--}for(;b&&D;){let T=L[D-1],M=n[b-1],K=T.key,W=M.key;T===M?(g=T.first,b--,D--):q.has(W)?!s.has(K)||G.has(K)?ie(T):oe.has(W)?b--:$.get(K)>$.get(W)?(oe.add(K),ie(T)):(G.add(W),b--):(h(M,s),b--)}for(;b--;){let T=n[b];q.has(T.key)||h(T,s)}for(;D;)ie(L[D-1]);return Q(ee),L}var Co=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],To=new Set([...Co]);function $e(n,e,t){let o=n.$$.props[e];o!==void 0&&(n.$$.bound[o]=t,t(n.$$.ctx[o]))}function ye(n){n&&n.c()}function me(n,e,t){let{fragment:o,after_update:r}=n.$$;o&&o.m(e,t),Le(()=>{let i=n.$$.on_mount.map(Dt).filter(le);n.$$.on_destroy?n.$$.on_destroy.push(...i):Q(i),n.$$.on_mount=[]}),r.forEach(Le)}function pe(n,e){let t=n.$$;t.fragment!==null&&(En(t.after_update),Q(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Fo(n,e){n.$$.dirty[0]===-1&&(ze.push(n),kn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function O(n,e,t,o,r,i,s,a=[-1]){let h=Qe;De(n);let l=n.$$={fragment:null,ctx:[],props:i,update:J,not_equal:r,bound:ht(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:ht(),dirty:a,skip_bound:!1,root:e.target||h.$$.root};s&&s(l.root);let g=!1;if(l.ctx=t?t(n,e.props||{},(c,b,...D)=>{let v=D.length?D[0]:b;return l.ctx&&r(l.ctx[c],l.ctx[c]=v)&&(!l.skip_bound&&l.bound[c]&&l.bound[c](v),g&&Fo(n,c)),b}):[],l.update(),g=!0,Q(l.before_update),l.fragment=o?o(l.ctx):!1,e.target){if(e.hydrate){gn();let c=yn(e.target);l.fragment&&l.fragment.l(c),c.forEach(w)}else l.fragment&&l.fragment.c();e.intro&&P(n.$$.fragment),me(n,e.target,e.anchor),bn(),yt()}De(h)}var Po;typeof HTMLElement=="function"&&(Po=class extends HTMLElement{constructor(e,t,o){super();re(this,"$$ctor");re(this,"$$s");re(this,"$$c");re(this,"$$cn",!1);re(this,"$$d",{});re(this,"$$r",!1);re(this,"$$p_d",{});re(this,"$$l",{});re(this,"$$l_u",new Map);this.$$ctor=e,this.$$s=t,o&&this.attachShadow({mode:"open"})}addEventListener(e,t,o){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){let r=this.$$c.$on(e,t);this.$$l_u.set(t,r)}super.addEventListener(e,t,o)}removeEventListener(e,t,o){if(super.removeEventListener(e,t,o),this.$$c){let r=this.$$l_u.get(t);r&&(r(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(i){return()=>{let s;return{c:function(){s=_("slot"),i!=="default"&&E(s,"name",i)},m:function(l,g){k(l,s,g)},d:function(l){l&&w(s)}}}};if(await Promise.resolve(),!this.$$cn)return;let t={},o=wn(this);for(let i of this.$$s)i in o&&(t[i]=[e(i)]);for(let i of this.attributes){let s=this.$$g_p(i.name);s in this.$$d||(this.$$d[s]=Ht(s,i.value,this.$$p_d,"toProp"))}this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:t,$$scope:{ctx:[]}}});let r=()=>{this.$$r=!0;for(let i in this.$$p_d)if(this.$$d[i]=this.$$c.$$.ctx[this.$$c.$$.props[i]],this.$$p_d[i].reflect){let s=Ht(i,this.$$d[i],this.$$p_d,"toAttribute");s==null?this.removeAttribute(i):this.setAttribute(this.$$p_d[i].attribute||i,s)}this.$$r=!1};this.$$c.$$.after_update.push(r),r();for(let i in this.$$l)for(let s of this.$$l[i]){let a=this.$$c.$on(i,s);this.$$l_u.set(s,a)}this.$$l={}}}attributeChangedCallback(e,t,o){var r;this.$$r||(e=this.$$g_p(e),this.$$d[e]=Ht(e,o,this.$$p_d,"toProp"),(r=this.$$c)==null||r.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(e){return Object.keys(this.$$p_d).find(t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e)||e}});function Ht(n,e,t,o){var i;let r=(i=t[n])==null?void 0:i.type;if(e=r==="Boolean"&&typeof e!="boolean"?e!=null:e,!o||!t[n])return e;if(o==="toAttribute")switch(r){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e==null?null:e;default:return e}else switch(r){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}var F=class{constructor(){re(this,"$$");re(this,"$$set")}$destroy(){pe(this,1),this.$destroy=J}$on(e,t){if(!le(t))return J;let o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{let r=o.indexOf(t);r!==-1&&o.splice(r,1)}}$set(e){this.$$set&&!dn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var Sn="4";typeof window!="undefined"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Sn);var Yt=require("obsidian");function Ae(n,e){return(0,Yt.setIcon)(n,e),{update(t){(0,Yt.setIcon)(n,t)}}}var Yo=mo(An());function Dn(n){let e=n-1;return e*e*e+1}function Zt(n,{delay:e=0,duration:t=400,easing:o=Dn,axis:r="y"}={}){let i=getComputedStyle(n),s=+i.opacity,a=r==="y"?"height":"width",h=parseFloat(i[a]),l=r==="y"?["top","bottom"]:["left","right"],g=l.map(q=>`${q[0].toUpperCase()}${q.slice(1)}`),c=parseFloat(i[`padding${g[0]}`]),b=parseFloat(i[`padding${g[1]}`]),D=parseFloat(i[`margin${g[0]}`]),v=parseFloat(i[`margin${g[1]}`]),x=parseFloat(i[`border${g[0]}Width`]),L=parseFloat(i[`border${g[1]}Width`]);return{delay:e,duration:t,easing:o,css:q=>`overflow: hidden;opacity: ${Math.min(q*20,1)*s};${a}: ${q*h}px;padding-${l[0]}: ${q*c}px;padding-${l[1]}: ${q*b}px;margin-${l[0]}: ${q*D}px;margin-${l[1]}: ${q*v}px;border-${l[0]}-width: ${q*x}px;border-${l[1]}-width: ${q*L}px;`}}function jn(n){let e,t,o,r;return{c(){e=_("div"),E(e,"class","js-engine-message-delete-icon callout-icon"),E(e,"aria-label","remove"),E(e,"role","button"),E(e,"tabindex","0")},m(i,s){k(i,e,s),o||(r=[ne(e,"click",n[5]),ne(e,"keydown",n[6]),Pe(t=Ae.call(null,e,"x"))],o=!0)},p:J,d(i){i&&w(e),o=!1,Q(r)}}}function Nn(n){let e,t=n[0].message.content+"",o;return{c(){e=_("p"),o=B(t)},m(r,i){k(r,e,i),f(e,o)},p(r,i){i&1&&t!==(t=r[0].message.content+"")&&Z(o,t)},d(r){r&&w(e)}}}function qn(n){let e,t,o=n[0].message.code+"",r;return{c(){e=_("pre"),t=_("code"),r=B(o),E(e,"class","language-none")},m(i,s){k(i,e,s),f(e,t),f(t,r)},p(i,s){s&1&&o!==(o=i[0].message.code+"")&&Z(r,o)},d(i){i&&w(e)}}}function Bn(n){let e,t,o,r=n[0].message.type+"",i,s,a,h,l=n[0].time.toISOString()+"",g,c,b,D,v=n[3]&&Rn(n);return{c(){e=_("div"),t=_("p"),o=B("Type: "),i=B(r),s=j(),a=_("p"),h=B("Time: "),g=B(l),c=j(),v&&v.c(),E(e,"class","js-engine-message-detail-content")},m(x,L){k(x,e,L),f(e,t),f(t,o),f(t,i),f(e,s),f(e,a),f(a,h),f(a,g),f(e,c),v&&v.m(e,null),D=!0},p(x,L){(!D||L&1)&&r!==(r=x[0].message.type+"")&&Z(i,r),(!D||L&1)&&l!==(l=x[0].time.toISOString()+"")&&Z(g,l),x[3]?v?v.p(x,L):(v=Rn(x),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i(x){D||(x&&Le(()=>{D&&(b||(b=kt(e,Zt,{duration:100},!0)),b.run(1))}),D=!0)},o(x){x&&(b||(b=kt(e,Zt,{duration:100},!1)),b.run(0)),D=!1},d(x){x&&w(e),v&&v.d(),x&&b&&b.end()}}}function Rn(n){let e,t,o=n[0].source.name+"",r,i,s,a,h=n[0].source.id+"",l;return{c(){e=_("p"),t=B("Source Name: "),r=B(o),i=j(),s=_("p"),a=B("Source ID: "),l=B(h)},m(g,c){k(g,e,c),f(e,t),f(e,r),k(g,i,c),k(g,s,c),f(s,a),f(s,l)},p(g,c){c&1&&o!==(o=g[0].source.name+"")&&Z(r,o),c&1&&h!==(h=g[0].source.id+"")&&Z(l,h)},d(g){g&&(w(e),w(i),w(s))}}}function ai(n){let e,t,o,r,i,s,a=n[0].message.title+"",h,l,g,c,b,D,v,x,L,q,$,ee,G,oe,ie,T,M,K,W=n[2]&&jn(n),y=n[0].message.content&&Nn(n),m=n[0].message.code&&qn(n),u=n[4]&&Bn(n);return{c(){e=_("div"),t=_("div"),o=_("div"),i=j(),s=_("span"),h=B(a),l=j(),W&&W.c(),g=j(),c=_("div"),y&&y.c(),b=j(),m&&m.c(),D=j(),v=_("div"),x=_("div"),L=_("span"),L.textContent="Details",q=j(),$=_("div"),oe=j(),u&&u.c(),E(o,"class","js-engine-message-icon callout-icon"),E(s,"class","js-engine-message-title"),E(t,"class","js-engine-message-header callout-title"),E($,"class","js-engine-message-icon"),E(x,"class","js-engine-message-detail-row"),E(x,"aria-expanded",G=n[4]?"true":"false"),E(x,"role","button"),E(x,"tabindex","0"),E(v,"class","js-engine-message-detail"),E(c,"class","js-engine-message-content callout-content"),E(e,"class",ie="js-engine-message callout "+$t(n[0].message.type)),E(e,"data-callout",T=n[0].message.type)},m(p,d){k(p,e,d),f(e,t),f(t,o),f(t,i),f(t,s),f(s,h),f(t,l),W&&W.m(t,null),f(e,g),f(e,c),y&&y.m(c,null),f(c,b),m&&m.m(c,null),f(c,D),f(c,v),f(v,x),f(x,L),f(x,q),f(x,$),f(v,oe),u&&u.m(v,null),M||(K=[Pe(r=Ae.call(null,o,en(n[0].message.type))),Pe(ee=Ae.call(null,$,n[4]?"chevron-down":"chevron-right")),ne(x,"click",n[7]),ne(x,"keydown",n[8])],M=!0)},p(p,[d]){r&&le(r.update)&&d&1&&r.update.call(null,en(p[0].message.type)),d&1&&a!==(a=p[0].message.title+"")&&Z(h,a),p[2]?W?W.p(p,d):(W=jn(p),W.c(),W.m(t,null)):W&&(W.d(1),W=null),p[0].message.content?y?y.p(p,d):(y=Nn(p),y.c(),y.m(c,b)):y&&(y.d(1),y=null),p[0].message.code?m?m.p(p,d):(m=qn(p),m.c(),m.m(c,D)):m&&(m.d(1),m=null),ee&&le(ee.update)&&d&16&&ee.update.call(null,p[4]?"chevron-down":"chevron-right"),d&16&&G!==(G=p[4]?"true":"false")&&E(x,"aria-expanded",G),p[4]?u?(u.p(p,d),d&16&&P(u,1)):(u=Bn(p),u.c(),P(u,1),u.m(v,null)):u&&(Se(),N(u,1,1,()=>{u=null}),Ce()),d&1&&ie!==(ie="js-engine-message callout "+$t(p[0].message.type))&&E(e,"class",ie),d&1&&T!==(T=p[0].message.type)&&E(e,"data-callout",T)},i(p){P(u)},o(p){N(u)},d(p){p&&w(e),W&&W.d(),y&&y.d(),m&&m.d(),u&&u.d(),M=!1,Q(K)}}}function ui(n,e,t){let{messageWrapper:o}=e,{messageManager:r}=e,{showDeleteButton:i=!0}=e,{showMessageSource:s=!0}=e,a=!1,h=()=>r.removeMessage(o.uuid),l=b=>b.key===" "?r.removeMessage(o.uuid):void 0,g=()=>t(4,a=!a),c=b=>b.key===" "?t(4,a=!a):void 0;return n.$$set=b=>{"messageWrapper"in b&&t(0,o=b.messageWrapper),"messageManager"in b&&t(1,r=b.messageManager),"showDeleteButton"in b&&t(2,i=b.showDeleteButton),"showMessageSource"in b&&t(3,s=b.showMessageSource)},[o,r,i,s,a,h,l,g,c]}var Kt=class extends F{constructor(e){super(),O(this,e,ui,ai,A,{messageWrapper:0,messageManager:1,showDeleteButton:2,showMessageSource:3})}},et=Kt;function Jn(n,e,t){let o=n.slice();return o[4]=e[t][0],o[5]=e[t][1],o[6]=e,o[7]=t,o}function Wn(n){let e;return{c(){e=_("p"),e.textContent="None"},m(t,o){k(t,e,o)},p:J,d(t){t&&w(e)}}}function zn(n){let e,t,o;function r(s){n[3](s,n[5],n[6],n[7])}let i={messageManager:n[0]};return n[5]!==void 0&&(i.messageWrapper=n[5]),e=new et({props:i}),ve.push(()=>$e(e,"messageWrapper",r)),{c(){ye(e.$$.fragment)},m(s,a){me(e,s,a),o=!0},p(s,a){n=s;let h={};a&1&&(h.messageManager=n[0]),!t&&a&2&&(t=!0,h.messageWrapper=n[5],Ke(()=>t=!1)),e.$set(h)},i(s){o||(P(e.$$.fragment,s),o=!0)},o(s){N(e.$$.fragment,s),o=!1},d(s){pe(e,s)}}}function ci(n){let e,t,o,r,i=ke(n[1]),s=[];for(let l=0;l<i.length;l+=1)s[l]=zn(Jn(n,i,l));let a=l=>N(s[l],1,1,()=>{s[l]=null}),h=null;return i.length||(h=Wn(n)),{c(){e=_("h2"),e.textContent="Messages",t=j(),o=_("div");for(let l=0;l<s.length;l+=1)s[l].c();h&&h.c()},m(l,g){k(l,e,g),k(l,t,g),k(l,o,g);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(o,null);h&&h.m(o,null),r=!0},p(l,[g]){if(g&3){i=ke(l[1]);let c;for(c=0;c<i.length;c+=1){let b=Jn(l,i,c);s[c]?(s[c].p(b,g),P(s[c],1)):(s[c]=zn(b),s[c].c(),P(s[c],1),s[c].m(o,null))}for(Se(),c=i.length;c<s.length;c+=1)a(c);Ce(),!i.length&&h?h.p(l,g):i.length?h&&(h.d(1),h=null):(h=Wn(l),h.c(),h.m(o,null))}},i(l){if(!r){for(let g=0;g<i.length;g+=1)P(s[g]);r=!0}},o(l){s=s.filter(Boolean);for(let g=0;g<s.length;g+=1)N(s[g]);r=!1},d(l){l&&(w(e),w(t),w(o)),Ve(s,l),h&&h.d()}}}function fi(n,e,t){let o,{messageManager:r}=e,i=r.messages;mn(n,i,a=>t(1,o=a));function s(a,h,l,g){l[g][1]=a,i.set(o)}return n.$$set=a=>{"messageManager"in a&&t(0,r=a.messageManager)},[r,o,i,s]}var tn=class extends F{constructor(e){super(),O(this,e,fi,ci,A,{messageManager:0})}},Hn=tn;var Et=class extends Un.Modal{constructor(t,o){super(t);this.plugin=o}onOpen(){this.contentEl.empty(),this.component&&this.component.$destroy(),this.component=new Hn({target:this.contentEl,props:{messageManager:this.plugin.messageManager}})}onClose(){this.contentEl.empty(),this.component&&this.component.$destroy()}};function Gn(n){return new nn(n)}var nn=class{constructor(e){this.value=e,this.subscriberCounter=0,this.subscribers=new Map}set(e){this.value!==e&&(this.value=e,this.notify())}update(e){this.set(e(this.value))}get(){return this.value}subscribe(e,t){let o=this.subscriberCounter;return this.subscriberCounter+=1,this.subscribers.set(o,e),e(this.value),()=>{this.subscribers.delete(o)}}notify(){for(let e of this.subscribers.values())e(this.value)}};function Yn(n){return[...n]}var di=["error","warning","success","tip","info"];function $t(n){return`js-engine-message-mod-${n}`}function en(n){var t;let e=new Map;return e.set("error","zap"),e.set("warning","alert-triangle"),e.set("success","check"),e.set("tip","flame"),e.set("info","info"),(t=e.get(n))!=null?t:"info"}function mi(n){return`js-engine-message-indicator-mod-${n}`}var xt=class{constructor(e,t,o,r){this.type=e,this.title=t,this.content=o,this.code=r}},pt=class{constructor(e,t){this.message=e,this.source=t,this.uuid=self.crypto.randomUUID(),this.time=(0,St.moment)()}},Mt=class{constructor(e,t){this.app=e,this.plugin=t,this.messages=Gn(new Map)}initStatusBarItem(){this.messageDisplay=new Et(this.app,this.plugin),this.statusBarItem=this.plugin.addStatusBarItem(),this.statusBarItem.addClass("mod-clickable"),this.statusBarItem.addEventListener("click",()=>{var e;(e=this.messageDisplay)==null||e.open()}),this.updateStatusBarItem(),this.messages.subscribe(e=>{this.updateStatusBarItem()})}addMessage(e,t){let o=new pt(e,t);return this.messages.get().set(o.uuid,o),this.messages.notify(),o}removeMessage(e){this.messages.get().delete(e),this.messages.notify()}updateStatusBarItem(){if(!this.statusBarItem)return;this.statusBarItem.empty();let e=this.statusBarItem.createEl("div");(0,St.setIcon)(e,"message-square");let t=this.statusBarItem.createEl("span");t.addClass("js-engine-message-counter"),t.innerText=this.messages.get().size.toString();let o=new Set(Array.from(this.messages.get().values()).map(r=>r.message.type));for(let r of di)if(o.has(r)){t.addClass(mi(r));break}o.size===0&&t.addClass("js-engine-message-indicator-mod-info")}getMessagesFromSource(e){let t=this.messages.get();return Yn(t.values()).filter(o=>o.source.id===e.id)}};var Ct=class extends Je.MarkdownRenderChild{constructor(t,o,r,i){super(t);this.plugin=o,this.content=r,this.ctx=i}getExecutionFile(){if(!this.ctx.sourcePath)return;let t=this.plugin.app.vault.getAbstractFileByPath(this.ctx.sourcePath);if(t&&t instanceof Je.TFile)return t}buildExecutionContext(){console.log(this.ctx);let t=this.getExecutionFile();return{file:t,metadata:this.plugin.app.metadataCache.getFileCache(t),line:0}}buildExecutionArgs(t){return[{key:"component",value:this},{key:"container",value:t}]}async tryRun(t,o){return this.plugin.jsEngine.execute(this.content,t,o)}async renderResults(t){let o=this.buildExecutionArgs(t),r=this.buildExecutionContext();this.jsExecution=await this.tryRun(o,r);let i=this.jsExecution.result;if(i){if(typeof i=="string"){t.innerText=i;return}if(i instanceof Ue&&(i=i.toMarkdown()),i instanceof Re){console.log(i.content),await i.render(t,this.ctx.sourcePath,this);return}i instanceof HTMLElement&&t.append(i),i instanceof pt&&new et({target:t,props:{messageWrapper:i,messageManager:this.plugin.messageManager,showDeleteButton:!1,showMessageSource:!1}})}}renderExecutionStats(t){let o=new Je.Menu;o.addItem(i=>{i.setTitle("Info"),i.setIcon("info"),i.onClick(()=>{var s;(s=this.jsExecution)==null||s.openStatsModal()})}),o.addItem(i=>{i.setTitle("Rerun"),i.setIcon("rotate-ccw"),i.onClick(()=>{this.render()})});let r=t.createDiv();r.addClass("js-engine-execution-stats-button"),r.addEventListener("click",i=>{o.showAtMouseEvent(i)}),(0,Je.setIcon)(r,"info")}async render(){var t,o;this.containerEl.empty(),this.containerEl.hasClass("js-engine-execution-render-child")||this.containerEl.addClass("js-engine-execution-render-child");try{await this.renderResults(this.containerEl),this.renderExecutionStats(this.containerEl)}catch(r){this.containerEl.innerText=r instanceof Error?(o=(t=r.stack)==null?void 0:t.toString())!=null?o:"":r,this.containerEl.addClass("mod-warning")}}async onload(){console.log("load"),await this.render()}onunload(){console.log("unload")}};var Tt=class{constructor(e){this.apiInstance=e}createBuilder(){return new Ue}create(e){return new Re(e)}createText(e){return new Me(e,!1,!1,!1)}createBoldText(e){return new Me(e,!0,!1,!1)}createCursiveText(e){return new Me(e,!1,!0,!1)}createUnderlinedText(e){return new Me(e,!1,!1,!0)}createCode(e){return new it(e)}createParagraph(e){return new st(e)}createHeading(e,t){return new rt(e,t)}createBlockQuote(){return new at}createCallout(e,t,o=""){return new ut(e,t,o)}createCodeBlock(e,t){return new lt(e,t)}createTable(e,t){return new ct(e,t)}};var It=class{constructor(e){this.apiInstance=e,this.messageManager=e.plugin.messageManager}createMessage(e,t,o,r=""){return this.messageManager.addMessage(new xt(e,t,o,r),this.apiInstance.instanceId)}getMessageById(e){return this.messageManager.messages.get().get(e)}getMessagesForInstance(){return this.messageManager.getMessagesFromSource(this.apiInstance.instanceId)}};var tt=class{constructor(e,t,o){this.app=e,this.plugin=t,this.instanceId=o,this.markdown=new Tt(this),this.message=new It(this)}async importJs(e){return import(this.app.vault.adapter.getResourcePath(e))}getPlugin(e){return this.app.plugins.getPlugin(e)}};var We=class{constructor(e,t){this.name=e,this.id=t}static create(e){return new We(e,self.crypto.randomUUID())}};var hi=async function(){}.constructor,Ft=class{constructor(e,t,o,r,i){this.app=e,this.plugin=t,this.code=o,this.context=i,this.uuid=self.crypto.randomUUID(),this.apiInstance=new tt(this.app,this.plugin,new We("JS_EXECUTION",this.uuid)),this.messages=[],this.func=void 0,this.args=[{key:"app",value:this.app},{key:"engine",value:this.apiInstance},{key:"context",value:this.context},...r]}buildFunction(){var t;let e=performance.now();try{this.func=hi(...this.args.map(o=>o.key),this.code)}catch(o){o instanceof Error&&(this.functionBuildError=o,this.result=(t=this.plugin.api)==null?void 0:t.message.createMessage("error","Failed to parse JS",`Failed to parse JS during execution "${this.uuid}"`,o.stack))}this.functionBuildTime=performance.now()-e}async runFunction(){if(this.functionBuildError)throw new Error("can not run function, function construction failed");if(!this.func)throw new Error("can not run function, function has not been constructed yet");let e=performance.now();try{this.result=await Promise.resolve(this.func(...this.args.map(t=>t.value)))}catch(t){t instanceof Error&&(this.functionRunError=t,this.result=this.apiInstance.message.createMessage("error","Failed to execute JS",`Failed to execute JS during execution "${this.uuid}"`,t.stack))}this.messages=this.apiInstance.message.getMessagesForInstance(),this.functionRunTime=performance.now()-e}isSuccessful(){return!this.functionBuildError&&!this.functionRunError}getMessages(){return this.messages}openStatsModal(){this.plugin.jsEngine.openExecutionStatsModal(this)}};var to=require("obsidian");function Vn(n,e,t){let o=n.slice();return o[2]=e[t],o}function Qn(n,e,t){let o=n.slice();return o[5]=e[t],o}function Xn(n){let e;return{c(){e=_("tr"),e.innerHTML="<td>none</td> <td>-</td> "},m(t,o){k(t,e,o)},p:J,d(t){t&&w(e)}}}function Zn(n,e){let t,o,r=e[5].key+"",i,s,a,h=typeof e[5].value,l,g;return{key:n,first:null,c(){t=_("tr"),o=_("td"),i=B(r),s=j(),a=_("td"),l=B(h),g=j(),this.first=t},m(c,b){k(c,t,b),f(t,o),f(o,i),f(t,s),f(t,a),f(a,l),f(t,g)},p(c,b){e=c,b&1&&r!==(r=e[5].key+"")&&Z(i,r),b&1&&h!==(h=typeof e[5].value)&&Z(l,h)},d(c){c&&w(t)}}}function Kn(n){let e;return{c(){e=_("p"),e.textContent="None"},m(t,o){k(t,e,o)},p:J,d(t){t&&w(e)}}}function $n(n){let e,t;return e=new et({props:{messageWrapper:n[2],messageManager:n[0].plugin.messageManager,showDeleteButton:!1,showMessageSource:!1}}),{c(){ye(e.$$.fragment)},m(o,r){me(e,o,r),t=!0},p(o,r){let i={};r&1&&(i.messageManager=o[0].plugin.messageManager),e.$set(i)},i(o){t||(P(e.$$.fragment,o),t=!0)},o(o){N(e.$$.fragment,o),t=!1},d(o){pe(e,o)}}}function _i(n){var rn,sn;let e,t,o,r,i,s=n[0].uuid+"",a,h,l,g,c,b,D=n[0].code+"",v,x,L,q,$,ee,G=Math.round((rn=n[0].functionBuildTime)!=null?rn:0)+"",oe,ie,T,M,K,W=Math.round((sn=n[0].functionRunTime)!=null?sn:0)+"",y,m,u,p,d,C,S,R,Y,U,z=[],ae=new Map,Oe,xe,qe,de,V,se=ke(n[0].args),Be=I=>I[5].key;for(let I=0;I<se.length;I+=1){let H=Qn(n,se,I),ce=Be(H);ae.set(ce,z[I]=Zn(ce,H))}let te=null;se.length||(te=Xn(n));let Ie=ke(n[1]),X=[];for(let I=0;I<Ie.length;I+=1)X[I]=$n(Vn(n,Ie,I));let oo=I=>N(X[I],1,1,()=>{X[I]=null}),ue=null;return Ie.length||(ue=Kn(n)),{c(){e=_("div"),t=_("h2"),t.textContent="JS Execution Stats",o=j(),r=_("p"),i=B("Execution ID: "),a=B(s),h=j(),l=_("h3"),l.textContent="Code",g=j(),c=_("pre"),b=_("code"),v=B(D),x=j(),L=_("h3"),L.textContent="Time",q=j(),$=_("p"),ee=B("Build Time: "),oe=B(G),ie=B(" ms"),T=j(),M=_("p"),K=B("Execution Time: "),y=B(W),m=B(" ms"),u=j(),p=_("h3"),p.textContent="Arguments",d=j(),C=_("div"),S=_("table"),R=_("thead"),R.innerHTML="<tr><th>Argument Name</th> <th>Value Type</th></tr>",Y=j(),U=_("tbody");for(let I=0;I<z.length;I+=1)z[I].c();te&&te.c(),Oe=j(),xe=_("h3"),xe.textContent="Messages",qe=j(),de=_("div");for(let I=0;I<X.length;I+=1)X[I].c();ue&&ue.c(),E(c,"class","language-none"),E(C,"class","markdown-rendered")},m(I,H){k(I,e,H),f(e,t),f(e,o),f(e,r),f(r,i),f(r,a),f(e,h),f(e,l),f(e,g),f(e,c),f(c,b),f(b,v),f(e,x),f(e,L),f(e,q),f(e,$),f($,ee),f($,oe),f($,ie),f(e,T),f(e,M),f(M,K),f(M,y),f(M,m),f(e,u),f(e,p),f(e,d),f(e,C),f(C,S),f(S,R),f(S,Y),f(S,U);for(let ce=0;ce<z.length;ce+=1)z[ce]&&z[ce].m(U,null);te&&te.m(U,null),f(e,Oe),f(e,xe),f(e,qe),f(e,de);for(let ce=0;ce<X.length;ce+=1)X[ce]&&X[ce].m(de,null);ue&&ue.m(de,null),V=!0},p(I,[H]){var ce,ln;if((!V||H&1)&&s!==(s=I[0].uuid+"")&&Z(a,s),(!V||H&1)&&D!==(D=I[0].code+"")&&Z(v,D),(!V||H&1)&&G!==(G=Math.round((ce=I[0].functionBuildTime)!=null?ce:0)+"")&&Z(oe,G),(!V||H&1)&&W!==(W=Math.round((ln=I[0].functionRunTime)!=null?ln:0)+"")&&Z(y,W),H&1&&(se=ke(I[0].args),z=Mn(z,H,Be,1,I,se,ae,U,xn,Zn,null,Qn),!se.length&&te?te.p(I,H):se.length?te&&(te.d(1),te=null):(te=Xn(I),te.c(),te.m(U,null))),H&3){Ie=ke(I[1]);let fe;for(fe=0;fe<Ie.length;fe+=1){let an=Vn(I,Ie,fe);X[fe]?(X[fe].p(an,H),P(X[fe],1)):(X[fe]=$n(an),X[fe].c(),P(X[fe],1),X[fe].m(de,null))}for(Se(),fe=Ie.length;fe<X.length;fe+=1)oo(fe);Ce(),!Ie.length&&ue?ue.p(I,H):Ie.length?ue&&(ue.d(1),ue=null):(ue=Kn(I),ue.c(),ue.m(de,null))}},i(I){if(!V){for(let H=0;H<Ie.length;H+=1)P(X[H]);V=!0}},o(I){X=X.filter(Boolean);for(let H=0;H<X.length;H+=1)N(X[H]);V=!1},d(I){I&&w(e);for(let H=0;H<z.length;H+=1)z[H].d();te&&te.d(),Ve(X,I),ue&&ue.d()}}}function gi(n,e,t){let{execution:o}=e,r=o.getMessages();return n.$$set=i=>{"execution"in i&&t(0,o=i.execution)},[o,r]}var on=class extends F{constructor(e){super(),O(this,e,gi,_i,A,{execution:0})}},eo=on;var Pt=class extends to.Modal{constructor(t,o){super(t);this.plugin=o}setExecution(t){this.execution=t}onOpen(){this.contentEl.empty(),this.component&&this.component.$destroy(),this.contentEl.hasClass("js-engine-execution-stats-modal")||this.contentEl.addClass("js-engine-execution-stats-modal"),this.component=new eo({target:this.contentEl,props:{execution:this.execution}})}onClose(){this.contentEl.empty(),this.component&&this.component.$destroy()}};var At=class{constructor(e,t){this.app=e,this.plugin=t,this.executionStatsModal=new Pt(this.app,this.plugin),this.activeExecutions=new Map}async execute(e,t,o){let r=new Ft(this.app,this.plugin,e,t,o);return this.activeExecutions.set(r.uuid,r),r.buildFunction(),r.functionBuildError||await r.runFunction(),this.activeExecutions.delete(r.uuid),r}openExecutionStatsModal(e){this.executionStatsModal.setExecution(e),this.executionStatsModal.open()}};var Ot=class extends no.Plugin{constructor(t,o){super(t,o);this.messageManager=new Mt(this.app,this),this.jsEngine=new At(this.app,this),this.api=new tt(this.app,this,We.create("PLUGIN"))}async onload(){await this.loadSettings(),this.messageManager.initStatusBarItem(),this.registerMarkdownCodeBlockProcessor("js-engine",(t,o,r)=>{let i=new Ct(o,this,t,r);r.addChild(i)}),this.app.workspace.onLayoutReady(async()=>{await this.registerCodeMirrorMode()})}onunload(){}async loadSettings(){this.settings=Object.assign({},cn,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async registerCodeMirrorMode(){let t=window.CodeMirror.getMode({},"javascript");if(t==null||t.name==="null"){console.log("Couldn't find js mode, can't enable syntax highlighting.");return}window.CodeMirror.defineMode("js-engine",o=>({startState:()=>({...window.CodeMirror.startState(t)}),blankLine:i=>null,copyState:i=>({...window.CodeMirror.startState(t)}),token:(i,s)=>`line-HyperMD-codeblock ${t.token&&t.token(i,s)}`}))}};
